import { Shell } from "@leight/mantine";
import { Callout } from "nextra-theme-docs";
import { SourceExample } from "../../../../components/SourceExample";
import { DefaultCalendar,CalendarWithInput } from "../../../../example/calendar-client";

# Calendar

<Callout type={'info'} emoji={'ℹ️'}>
    If you want to use `Calendar`, you must have [`DateTimeProvider`](../i18n-client/date-time-provider) from [`@leight/i18n-client`](../i18n-client) somewhere in the component tree.

    Or you can use [PageShell](../mantine/page-shell) or [Shell](../mantine/shell) from [@leight/mantine](../mantine).
</Callout>

<Callout>
    This package requires [Mantine UI](https://mantine.dev/) provided by [@leight/mantine](../mantine).
</Callout>

This package provides UI for rendering localized calendar. It's based on a great library [Luxon](https://moment.github.io/luxon/#/) providing
backend for date/time operations.

## Minimal example

<Callout>
    All Calendar instances needs (separate) [CalendarStoreProvider](./calendar-store-provider) to work; the reason you must provide you own store is to give you
    a **control** over the calendar outside of the component itself.
</Callout>

<Callout type={'info'} emoji={'ℹ️'}>
    Calendar defaults to **6 weeks** to prevent jumping on months with lesser week count.
</Callout>

<SourceExample
    example={<Shell>
                 <DefaultCalendar/>
             </Shell>}
>
```tsx filename="DefaultCalendar.tsx"
import {
    Calendar,
    CalendarProvider,
    type ICalendarProps
}                from "@leight/calendar-client";
import {type FC} from "react";

export interface IDefaultCalendarProps extends ICalendarProps {
}

export const DefaultCalendar: FC<IDefaultCalendarProps> = (props) => {
    return <CalendarProvider>
        <Calendar
            withControls={false}
            {...props}
        />
    </CalendarProvider>
};
```
</SourceExample>

## With input

<SourceExample
    example={<Shell>
                 <CalendarWithInput/>
             </Shell>}
>
```tsx filename="CalendarWithInput.tsx"
import {
    Calendar,
    CalendarProvider,
    type ICalendarProps,
    useCalendar
}                 from "@leight/calendar-client";
import {DateTime} from "@leight/i18n";
import {
    type FC,
    useEffect
}                 from "react";

export interface ICalendarWithInputProps extends ICalendarProps {
}

export const CalendarWithInput: FC<ICalendarWithInputProps> = (props) => {
    /**
     * Calendar is powered by its Calendar Store where state control and state itself lives.
     */
    return <CalendarProvider
        /**
         * You can pass input here or through the props; input is DateTime from Luxon
         */
        input={DateTime.fromObject({month: 2})}
        defaults={{
            /**
             * Set default loading state to emulate fetching calendar data
             */
            isLoading: true,
        }}
    >
        <CalendarInternal {...props}/>
    </CalendarProvider>;
};

interface ICalendarInternalProps extends ICalendarWithInputProps {
}

const CalendarInternal: FC<ICalendarInternalProps> = (props) => {
    /**
     * Control Calendar's loading state
     */
    const {loading} = useCalendar(({loading}) => ({loading}));
    useEffect(() => {
        setTimeout(() => {
            /**
             * Ou, "we have" data! Turn off loading
             */
            loading(false);
        }, 1000);
    }, []);
    return <Calendar
        {...props}
    />;
};
```
</SourceExample>

